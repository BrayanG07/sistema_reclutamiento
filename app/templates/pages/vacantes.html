{% extends "base.html" %}

{% block titulo %} Inicio {% endblock %}

{% block contenido %}

<div class="border p-3 shadow-lg rounded">

    <form method="POST">
        {% csrf_token %}

        <div class="row">

            <!-- COLUMNA 1 -->
            <div class="col-lg-3">
                <div class="mb-3">
                    <label for="txtJobPosition" class="form-label">Areas de trabajo</label>
                    <select class="form-select" aria-label="Default select example" name="txtJobPosition">
                        <option selected value="0">Selecciona el area de trabajo</option>
                        {% for item in list_job_position %}
                            <option value="{{ item.id }}" {% if job == item.id %} selected {% else %} '' {% endif %}>{{ item.name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="mb-3">
                    <label for="txtCountry" class="form-label">País</label>
                    <select class="form-select" aria-label="Default select example" name="txtCountry">
                        <option selected value="">Selecciona el país</option>
                        <option value="Honduras" {% if country == "Honduras" %} selected {% else %} '' {% endif %}>Honduras</option>
                        <option value="El Salvador" {% if country == "El Salvador" %} selected {% else %} '' {% endif %}>El Salvador</option>
                        <option value="Costa Rica" {% if country == "Costa Rica" %} selected {% else %} '' {% endif %}>Costa Rica</option>
                        <option value="Mexico" {% if country == "Mexico" %} selected {% else %} '' {% endif %}>Mexico</option>
                        <option value="Inglaterra" {% if country == "Inglaterra" %} selected {% else %} '' {% endif %}>Inglaterra</option>
                    </select>
                </div>

                <label for="txtSkills" class="form-label">Skills</label>
                <input type="hidden" name="txtCantidadSkills" id="txtCantidadSkills" value="0">
                <div class="mb-3" id="campos-dinamicos">
                    <div class="row">
                        <div class="col-10">
                            <input type="text" class="form-control" name="txtSkill0"
                                placeholder="Escriba el nombre de una skill" value="">
                        </div>
                        <div class="col-lg-2">
                            <button type="button" id="btnAddSkills" class="btn btn-info text-white"
                                data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip"
                                data-bs-title="Agregar otra skill.">
                                +
                            </button>
                        </div>

                    </div>
                </div>

                <div class="mb-3">
                    <label for="txtSkills" class="form-label">Ubicación</label>
                    <input type="text" class="form-control" name="txtUbication" placeholder="Ciudad" value="{{ city | default:'' }}">
                </div>

                <div class="mb-3">
                    <label for="txtYearExperiencia" class="form-label">Años de experiencia</label>
                    <input type="number" min="0" class="form-control" name="txtYearExperience" placeholder="0" value="{{ years | default:'' }}">
                </div>

                <div class="mb-3">
                    <label for="txtModalidad" class="form-label">Modalidad</label>
                    <select class="form-select" aria-label="Default select example" name="txtModality">
                        <option value="">Selecciona La Modalidad</option>
                        <option value="Presencial" {% if modality == "Presencial" %} selected {% else %} '' {% endif %}>Presencial</option>
                        <option value="Remoto" {% if modality == "Remoto" %} selected {% else %} '' {% endif %}>Remoto</option>
                    </select>
                </div>

                <div class="mb-3">
                    <button type="submit" class="btn btn-primary mb-3">APLICAR FILTROS</button>
                </div>

            </div>
            <!-- COLUMNA 2 -->
            <div class="col-lg-9">

                {% if error != '' %}
                    <div class="alert alert-warning alert-dismissible fade show" role="alert">
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        {{ error }}
                    </div>    
                {% else %}

                    {% for param in list_vacant %}
                    <div class="card mb-2 border shadow">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-6">
                                    <h5 class="card-title text-primary">{{ param.name_complete }}</h5>
                                </div>
                                <div class="col-lg-6 text-end">
                                    <h6 class="card-title">{{ param.country }} / {{ param.city }}</h6>
                                </div>
                                <hr>

                                <div class="col-lg-7">
                                    <h6 class="card-title text-center mb-5">Información Personal</h6>
                                    <p class="card-text px-3">
                                        {{ param.email }}
                                        <br>
                                        Modalidad de preferencia: <span style="font-style: italic;">{{ param.modality }}</span>
                                    </p>
                                    </p>
                                    <p class="blockquote-footer mb-0 px-4">{{ param.experience_start_date }} años de <cite
                                            title="Source Title">Experiencia</cite></p>
                                </div>
                                <div class="col-lg-5">
                                    <h6 class="card-title text-center">{{ param.name }}</h6>
                                    <ul class="list-group">
                                        {% for skills in list_skills %}
                                            {% if param.id == skills.vacant_id %}
                                                <li class="list-group-item">{{ skills.name }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                </div>

                            </div>
                        </div>
                    </div>
                    
                    {% empty %}

                        {% if job == 18 %} 
                            {% for p in data_api %} 
                                <div class="card mb-2 border shadow">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <h5 class="card-title text-primary">{{ p.name }}</h5>
                                            </div>
                                            <div class="col-lg-6 text-end">
                                                <h6 class="card-title">No Especificado</h6>
                                            </div>
                                            <hr>
            
                                            <div class="col-lg-7">
                                                <h6 class="card-title text-center">Información</h6>
                                                {% for dat in p.placements %}
                                                    <p class="card-text px-3">{{ dat.offer.title }}</p>
                                                {% endfor %}

                                                {% for par in p.emails %}
                                                    <p class="card-text px-3">{{ par }}</p>
                                                {% endfor %}
                                                
                                            </div>
            
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}

                            
                        {% else %}
                            <div class="alert alert-warning alert-dismissible fade show" role="alert">
                                Desafortunadamente no encontramos postulantes para tu busqueda.
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endif %}
                        
                    {% endfor %}    
                    
                {% endif %}

            </div>

    </form>


</div>

{% endblock %}